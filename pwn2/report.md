Готовый эксплоит: [solve.py](solve.py)

Исполняемый файл таков, что у нас есть доступ на запись к памяти размера `0x100` байт, при этом программа может совершить вызов функции `fclose` на с аргументом - указателем, состоящим из первых 8 байт этой области.

Создадим поддельную структуру `FILE *`, такую, что выполнив `fclose` на ней, мы получим шелл.

Для этого сначала вычислим адрес libc, воспользовавшись тем, что вывод данных производится при помощи `printf(data)`.

Далее создаем структуру с поддельной `vtable` таким образом, что на самом деле будет вызвана функция по нашему адресу. Находим подходящий адрес при помощи `one_gadget`.

И затем получаем флаг: `NTO{533_y0u_47_5ch00l_p4l}`