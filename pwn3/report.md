Готовый эксплоит: [solve.py](solve.py)

Как можно заметить, программа позволяет нам смотреть на участки памяти, которые уже были освобождены, а также редактировать их.

Для начала создаем несколько записей, потом удаляем их, тем самым заполняя tcache и unsorted bins. Смотря на содержимое одного из чанков, который попал в unsorted bins, мы можем получить адрес, куда была загружена libc.

Теперь переопределим `__free_hook` адресом (8 байт), прыгнув на который наша программа выдаст нам шелл. Для этого переопределим 4 байта по адресу `__free_hook`, а затем оставшиеся 4 байта по адресу `__free_hook+4`.

Переопределять 4 байта мы можем при помощи изменения структуры `tcache` таким образом, что адрес первого чанка будет указывать по адресу записи. Таким образом, при записи оценки (32-битного числа), мы запишем 4 байта в нужное место.

Осталось вызвать функцию `free` и получить флаг: `NTO{3ww_7h15_7c4ch3_15_p0150n3d}`